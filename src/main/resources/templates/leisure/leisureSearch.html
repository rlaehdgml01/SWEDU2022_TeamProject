<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.w3.org/1999/xhtml">
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
  <meta name="description" content=""/>
  <meta name="author" content=""/>
  <title>레저 디테일 페이지</title>
  <link rel="icon" type="image/x-icon" href="assets/favicon.ico"/>
  <!-- Font Awesome icons (free version)-->
  <script src="https://use.fontawesome.com/releases/v6.1.0/js/all.js" crossorigin="anonymous"></script>
  <!-- Google fonts-->
  <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet"
        type="text/css"/>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"
        rel="stylesheet" type="text/css"/>
  <!-- Core theme CSS (includes Bootstrap)-->
  <link href="css/styles.css" rel="stylesheet"/>
  <link href="css/review.css" rel="stylesheet"/>
  <Link href="css/leisure.css" rel="stylesheet"/>
  <!-- VENDOR CSS -->
  <link rel="stylesheet" href="assets/vendor/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/vendor/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="assets/vendor/linearicons/style.css">
  <!-- MAIN CSS -->
  <link rel="stylesheet" href="assets/css/main.css">
  <!-- FOR DEMO PURPOSES ONLY. You should remove this in your project -->
  <link rel="stylesheet" href="assets/css/demo.css">
  <!-- GOOGLE FONTS -->
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700" rel="stylesheet">
  <!-- ICONS -->
  <link rel="apple-touch-icon" sizes="76x76" href="assets/img/apple-icon.png">
  <link rel="icon" type="image/png" sizes="96x96" href="assets/img/favicon.png">
  <!--부트스트랩-->
  <script src="/webjars/jquery/3.5.1/jquery.min.js"></script>
  <script src="/webjars/bootstrap/4.5.0/js/bootstrap.min.js"></script>
  <!--주소 찾기 api-->
  <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
  <style>
    .masthead {
        height: 2vh;
    }

    .h1-title {
        position: relative;
        bottom: 90px;
    }

    body {
      font-size:9pt;
    }

    button {
        font-size:9pt;
    }

    table {
        margin: auto;
        width: 600px;
        border-collaps:collapse;
    }

    th, td {
        padding: 3px;
    }

    .input_title {
        width:98%;
    }

    .textarea_content {
        width:98%;
        height:70px;
    }

        .map_wrap, .map_wrap * {margin:0;padding:0;font-family:'Malgun Gothic',dotum,'돋움',sans-serif;font-size:12px;}
    .map_wrap a, .map_wrap a:hover, .map_wrap a:active{color:#000;text-decoration: none;}
    .map_wrap {position:relative;width:100%;height:500px;}
    #menu_wrap {position:absolute;top:0;left:0;bottom:0;width:250px;margin:10px 0 30px 10px;padding:5px;overflow-y:auto;background:rgba(255, 255, 255, 0.7);z-index: 1;font-size:12px;border-radius: 10px;}
    .bg_white {background:#fff;}
    #menu_wrap hr {display: block; height: 1px;border: 0; border-top: 2px solid #5F5F5F;margin:3px 0;}
    #menu_wrap .option{text-align: center;}
    #menu_wrap .option p {margin:10px 0;}
    #menu_wrap .option button {margin-left:5px;}
    #placesList li {list-style: none;}
    #placesList .item {position:relative;border-bottom:1px solid #888;overflow: hidden;cursor: pointer;min-height: 65px;}
    #placesList .item span {display: block;margin-top:4px;}
    #placesList .item h5, #placesList .item .info {text-overflow: ellipsis;overflow: hidden;white-space: nowrap;}
    #placesList .item .info{padding:10px 0 10px 55px;}
    #placesList .info .gray {color:#8a8a8a;}
    #placesList .info .jibun {padding-left:26px;background:url(https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/places_jibun.png) no-repeat;}
    #placesList .info .tel {color:#009900;}
    #placesList .item .markerbg {float:left;position:absolute;width:36px; height:37px;margin:10px 0 0 10px;background:url(https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_number_blue.png) no-repeat;}
    #placesList .item .marker_1 {background-position: 0 -10px;}
    #placesList .item .marker_2 {background-position: 0 -56px;}
    #placesList .item .marker_3 {background-position: 0 -102px}
    #placesList .item .marker_4 {background-position: 0 -148px;}
    #placesList .item .marker_5 {background-position: 0 -194px;}
    #placesList .item .marker_6 {background-position: 0 -240px;}
    #placesList .item .marker_7 {background-position: 0 -286px;}
    #placesList .item .marker_8 {background-position: 0 -332px;}
    #placesList .item .marker_9 {background-position: 0 -378px;}
    #placesList .item .marker_10 {background-position: 0 -423px;}
    #placesList .item .marker_11 {background-position: 0 -470px;}
    #placesList .item .marker_12 {background-position: 0 -516px;}
    #placesList .item .marker_13 {background-position: 0 -562px;}
    #placesList .item .marker_14 {background-position: 0 -608px;}
    #placesList .item .marker_15 {background-position: 0 -654px;}
    #pagination {margin:10px auto;text-align: center;}
    #pagination a {display:inline-block;margin-right:10px;}
    #pagination .on {font-weight: bold; cursor: default;color:#777;}
    </style>
  <script type="text/javascript">
      var cnt3 = 0;
      var cnt4 = 0;

      function logout_btn()
      {
        alert('로그아웃 되었습니다.');
      }

      function changeOn1() {
            if(cnt3 % 2 == 0) {
              var tag1 = document.getElementById("img");
              var switchOn = document.getElementById("b1");
              switchOn.style.background="lightgray";
			} else {
              var tag1 = document.getElementById("img");
              var switchOff = document.getElementById("b1"); //전구끄기 버튼 색변경
              switchOff.style.background="#288CFF";
            }
            cnt3 = cnt3 + 1;
	    }

	    function changeOn2() {
            if(cnt4 % 2 == 0) {
              var tag1 = document.getElementById("img");
              var switchOn = document.getElementById("b2");
              switchOn.style.background="lightgray";
			} else {
              var tag1 = document.getElementById("img");
              var switchOff = document.getElementById("b2"); //전구끄기 버튼 색변경
              switchOff.style.background="#288CFF";
            }
            cnt4 = cnt4 + 1;
		}
  </script>
</head>
<body>
<!-- Navigation-->
<nav class="navbar navbar-expand-lg navbar-light" id="mainNav">
  <div class="container px-4 px-lg-5">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive"
            aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu
      <i class="fas fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ms-auto py-4 py-lg-0">
        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="http://localhost:8090/leisureSearch"
                                id="a_home" style="font-size: x-large;">Leisure Map</a></li>
        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4"
                                href="http://localhost:8090/leisureSearch">레저검색</a></li>
        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="http://localhost:8090/reviewList">전체리뷰</a>
        </li>
        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="http://localhost:8090/marketList">레저마켓</a>
        </li>
        <li class="nav-item"><a th:if="${loginId} == null" class="nav-link px-lg-3 py-3 py-lg-4"
                                href="http://localhost:8090/memberLogin">로그인/회원가입</a></li>
        <li class="nav-item"><a th:unless="${loginId} == null" class="nav-link px-lg-3 py-3 py-lg-4"
                                href="http://localhost:8090/memberLogin"
                                th:text="'로그아웃' + '(' + ${loginId} + ')'" onclick="javascript:logout_btn()"></a></li>
      </ul>
    </div>
  </div>
</nav>
<!-- Page Header-->
<header class="masthead" style="background-color: #288CFF">
  <div class="container position-relative px-4 px-lg-5">
    <div class="row gx-4 gx-lg-5 justify-content-center">
      <div class="col-md-10 col-lg-8 col-xl-7">
        <div class="site-heading">
          <h1 class="h1-title">Leisure Search</h1>
        </div>
      </div>
    </div>
  </div>
</header>
<!-- Main Content-->
<div style="width: 100%; margin: auto; text-align: center;" class="div_box1">
  <div class="map_wrap">
    <!-- Road View -->
    <div id="container">
      <div id="rvWrapper">
        <div id="roadview" style="width:1%;height:50%;"></div> <!-- 로드뷰를 표시할 div 입니다 -->
      </div>
      <div id="mapWrapper"><!-- 지도를 표시할 div 입니다 -->
        <div id="roadviewControl" onclick="setRoadviewRoad()">
        </div>
      </div>
    </div>
    <!-- Map -->
    <div id="map" style="width: 65%; height: 100%; position:absolute; left: 500px; top: 3%; overflow:hidden;"></div>
    <div id="menu_wrap" class="bg_white" style="width: 30%;">
      <div class="option">
        <form th:action="@{/leisureSearch}" method="get">
          <strong class="strong_region">지역설정</strong>
          <select name="searchKeyword" class="select_sk">
            <option value="" selected>-- 선택 --</option>
            <option value="서울특별시">서울특별시</option>
            <option value="부산광역시">부산광역시</option>
            <option value="인천광역시">인천광역시</option>
            <option value="대구광역시">대구광역시</option>
            <option value="대전광역시">대전광역시</option>
            <option value="광주광역시">광주광역시</option>
            <option value="울산광역시">울산광역시</option>
            <option value="세종특별자치시">세종특별자치시</option>
            <option value="제주특별자치도">제주특별자치도</option>
            <option value="경기도">경기도</option>
            <option value="강원도">강원도</option>
            <option value="충청북도">충청북도</option>
            <option value="충청남도">충청남도</option>
            <option value="경상북도">경상북도</option>
            <option value="경상남도">경상남도</option>
            <option value="전라북도">전라북도</option>
            <option value="전라남도">전라남도</option>
          </select><br><br>
          <button type="submit" class="btn_sk">확인</button>
        </form>

        <br>
        <div th:if="${searchKeyword!=null}">
          <form th:action="@{/leisureSearch}" method="get">
            <strong class="strong_region2">행정구역</strong>
            <input name="searchKeyword" th:value="${searchKeyword}" class="input_sk">
            <select name="lerad" class="select_lerad">
              <option value="" selected>-- 선택 --</option>
              <option th:each="e: ${ad_list}" th:text="${e}"></option>
            </select> <br><br>
            <strong class="strong_region3">레저종류</strong>
            <input type="checkbox" name="lecname" value="골프" class="check_lec"><strong>골프</strong>
            <input type="checkbox" name="lecname" value="승마" class="check_lec"><strong>승마</strong>
            <input type="checkbox" name="lecname" value="스키" class="check_lec"><strong>스키</strong>
            <input type="checkbox" name="lecname" value="빙상" class="check_lec"><strong>빙상</strong>
            <br><br>
            <button type="submit" class="btn_sk">검색</button>

          </form>
          <!--검색어를 넣고 지도를 검색하는 함수인 searchPlace에 값 넣어주기 start-->
          <form onsubmit="searchPlaces(); return false;">
            <input type="hidden" id="do" th:value="${searchKeyword}">
            <input type="hidden" id="si" th:value="${lerad}">
            <input type="hidden" id="le_name" th:value="${lecname}">
          </form>
          <!--검색어를 넣고 지도를 검색하는 함수인 searchPlace에 값 넣어주기 end-->
        </div>
      </div>

      <ul id="placesList"></ul>
      <div id="pagination"></div>
    </div>

  </div>
  <!--Map에 드래그 기능과 확대 축소기능을 켜고 끄는 버튼-->
  <div class="btn_map_control">
    <button id="b1" onclick="setDraggable(); changeOn1();"><img src="assets/img/drag.png" style="width:30px; height:30px;" title="지도 드래그 이동 켜기"></button>
    <button id="b2" onclick="setZoomable(); changeOn2();"><img src="assets/img/pm.png" style="width:30px; height:30px;" title="지도 확대/축소 켜기"></button>
  </div>
  <!--맵 관련 스크립트-->
  <script type="text/javascript"
          src="//dapi.kakao.com/v2/maps/sdk.js?appkey=bb7e39d8a6c6e5815c18e0e130b80bd7&libraries=services"></script>
  <script>
      var cnt1 = 0;
      var cnt2 = 0;

      // 마커를 담을 배열입니다
      var markers = [];

      var mapContainer = document.getElementById('map'), // 지도를 표시할 div
          mapOption = {
              center: new kakao.maps.LatLng(37.566826, 126.9786567), // 지도의 중심좌표
              level: 3 // 지도의 확대 레벨
          };

      // 지도를 생성합니다
      var map = new kakao.maps.Map(mapContainer, mapOption);

      // 장소 검색 객체를 생성합니다
      var ps = new kakao.maps.services.Places();

      // 검색 결과 목록이나 마커를 클릭했을 때 장소명을 표출할 인포윈도우를 생성합니다
      var infowindow = new kakao.maps.InfoWindow({zIndex:1});

      // 키워드로 장소를 검색합니다
      searchPlaces();

      // 키워드 검색을 요청하는 함수입니다
      function searchPlaces() {

          var keyword = document.getElementById('do').value + document.getElementById('si').value + document.getElementById('le_name').value;

          if (!keyword.replace(/^\s+|\s+$/g, '')) {
              alert('키워드를 입력해주세요!');
              return false;
          }

          // 장소검색 객체를 통해 키워드로 장소검색을 요청합니다
          ps.keywordSearch( keyword, placesSearchCB);
      }

      // 장소검색이 완료됐을 때 호출되는 콜백함수 입니다
      function placesSearchCB(data, status, pagination) {
          if (status === kakao.maps.services.Status.OK) {

              // 정상적으로 검색이 완료됐으면
              // 검색 목록과 마커를 표출합니다
              displayPlaces(data);

              // 페이지 번호를 표출합니다
              displayPagination(pagination);

          } else if (status === kakao.maps.services.Status.ZERO_RESULT) {

              alert('검색 결과가 존재하지 않습니다.');
              return;

          } else if (status === kakao.maps.services.Status.ERROR) {

              alert('검색 결과 중 오류가 발생했습니다.');
              return;

          }
      }

      // 검색 결과 목록과 마커를 표출하는 함수입니다
      function displayPlaces(places) {

          var listEl = document.getElementById('placesList'),
          menuEl = document.getElementById('menu_wrap'),
          fragment = document.createDocumentFragment(),
          bounds = new kakao.maps.LatLngBounds(),
          listStr = '';

          // 검색 결과 목록에 추가된 항목들을 제거합니다
          removeAllChildNods(listEl);

          // 지도에 표시되고 있는 마커를 제거합니다
          removeMarker();

          for ( var i=0; i<places.length; i++ ) {

              // 마커를 생성하고 지도에 표시합니다
              var placePosition = new kakao.maps.LatLng(places[i].y, places[i].x),
                  marker = addMarker(placePosition, i),
                  itemEl = getListItem(i, places[i]); // 검색 결과 항목 Element를 생성합니다

              // 검색된 장소 위치를 기준으로 지도 범위를 재설정하기위해
              // LatLngBounds 객체에 좌표를 추가합니다
              bounds.extend(placePosition);

              // 마커와 검색결과 항목에 mouseover 했을때
              // 해당 장소에 인포윈도우에 장소명을 표시합니다
              // mouseout 했을 때는 인포윈도우를 닫습니다
              (function(marker, title) {
                  kakao.maps.event.addListener(marker, 'mouseover', function() {
                      displayInfowindow(marker, title);
                  });

                  kakao.maps.event.addListener(marker, 'mouseout', function() {
                      infowindow.close();
                  });

                  itemEl.onmouseover =  function () {
                      displayInfowindow(marker, title);
                  };

                  itemEl.onmouseout =  function () {
                      infowindow.close();
                  };
              })(marker, places[i].place_name);

              fragment.appendChild(itemEl);
          }

          // 검색결과 항목들을 검색결과 목록 Element에 추가합니다
          listEl.appendChild(fragment);
          menuEl.scrollTop = 0;

          // 검색된 장소 위치를 기준으로 지도 범위를 재설정합니다
          map.setBounds(bounds);
      }

      // 검색결과 항목을 Element로 반환하는 함수입니다
      function getListItem(index, places) {

          var el = document.createElement('li'),
          itemStr = '<span class="markerbg marker_' + (index+1) + '"></span>' +
                      '<div class="info">' +
                      '   <h5>' + places.place_name + '</h5>';

          if (places.road_address_name) {
              itemStr += '    <span>' + places.road_address_name + '</span>' +
                          '   <span class="jibun gray">' +  places.address_name  + '</span>';
          } else {
              itemStr += '    <span>' +  places.address_name  + '</span>';
          }

            itemStr += '  <span class="tel">' + places.phone  + '</span>' +
                      '</div>';

          el.innerHTML = itemStr;
          el.className = 'item';

          return el;
      }

      // 마커를 생성하고 지도 위에 마커를 표시하는 함수입니다
      function addMarker(position, idx, title) {
          var imageSrc = 'https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/marker_number_blue.png', // 마커 이미지 url, 스프라이트 이미지를 씁니다
              imageSize = new kakao.maps.Size(36, 37),  // 마커 이미지의 크기
              imgOptions =  {
                  spriteSize : new kakao.maps.Size(36, 691), // 스프라이트 이미지의 크기
                  spriteOrigin : new kakao.maps.Point(0, (idx*46)+10), // 스프라이트 이미지 중 사용할 영역의 좌상단 좌표
                  offset: new kakao.maps.Point(13, 37) // 마커 좌표에 일치시킬 이미지 내에서의 좌표
              },
              markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize, imgOptions),
                  marker = new kakao.maps.Marker({
                  position: position, // 마커의 위치
                  image: markerImage
              });

          marker.setMap(map); // 지도 위에 마커를 표출합니다
          markers.push(marker);  // 배열에 생성된 마커를 추가합니다

          return marker;
      }

      // 지도 위에 표시되고 있는 마커를 모두 제거합니다
      function removeMarker() {
          for ( var i = 0; i < markers.length; i++ ) {
              markers[i].setMap(null);
          }
          markers = [];
      }

      // 검색결과 목록 하단에 페이지번호를 표시는 함수입니다
      function displayPagination(pagination) {
          var paginationEl = document.getElementById('pagination'),
              fragment = document.createDocumentFragment(),
              i;

          // 기존에 추가된 페이지번호를 삭제합니다
          while (paginationEl.hasChildNodes()) {
              paginationEl.removeChild (paginationEl.lastChild);
          }

          for (i=1; i<=pagination.last; i++) {
              var el = document.createElement('a');
              el.href = "#";
              el.innerHTML = i;

              if (i===pagination.current) {
                  el.className = 'on';
              } else {
                  el.onclick = (function(i) {
                      return function() {
                          pagination.gotoPage(i);
                      }
                  })(i);
              }

              fragment.appendChild(el);
          }
          paginationEl.appendChild(fragment);
      }

      // 검색결과 목록 또는 마커를 클릭했을 때 호출되는 함수입니다
      // 인포윈도우에 장소명을 표시합니다
      function displayInfowindow(marker, title) {
          var content = '<div style="padding:5px;z-index:1;">' + title + '</div>';

          infowindow.setContent(content);
          infowindow.open(map, marker);
      }

       // 검색결과 목록의 자식 Element를 제거하는 함수입니다
      function removeAllChildNods(el) {
          while (el.hasChildNodes()) {
              el.removeChild (el.lastChild);
          }
      }

      // 맵 컨트롤
      var mapContainer = document.getElementById('map'), // 지도를 표시할 div
      mapOption = {
          center: new kakao.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표
           // draggable: false, // 지도를 생성할때 지도 이동 및 확대/축소를 막으려면 draggable: false 옵션을 추가하세요
          level: 3 // 지도의 확대 레벨
      };

      // 버튼 클릭에 따라 지도 이동 기능을 막거나 풀고 싶은 경우에는 map.setDraggable 함수를 사용합니다

      function setDraggable() {
          // 마우스 드래그로 지도 이동 가능여부를 설정합니다
          if(cnt1 % 2 == 0) {
            draggable = 0; // true
          } else {
            draggable = 1; // false
          }
          map.setDraggable(draggable);
          cnt1 = cnt1 + 1;
      }

      var mapContainer = document.getElementById('map'), // 지도를 표시할 div
          mapOption = {
              center: new kakao.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표
               // draggable: false, // 지도를 생성할때 지도 이동 및 확대/축소를 막으려면 draggable: false 옵션을 추가하세요
              level: 3 // 지도의 확대 레벨
          };


      // 버튼 클릭에 따라 지도 확대, 축소 기능을 막거나 풀고 싶은 경우에는 map.setZoomable 함수를 사용합니다
      function setZoomable() {
          // 마우스 휠로 지도 확대,축소 가능여부를 설정합니다
          if(cnt2 % 2 == 0) {
            zoomable = 0; // true
          } else {
            zoomable = 1; // false
          }
          map.setZoomable(zoomable);
          cnt2 = cnt2 + 1;
      }

      // 로드뷰 시작
      // 로드뷰 객체를 생성합니다
      var rv = new kakao.maps.Roadview(rvContainer);

      // 좌표로부터 로드뷰 파노라마 ID를 가져올 로드뷰 클라이언트 객체를 생성합니다
      var rvClient = new kakao.maps.RoadviewClient();

      // 로드뷰에 좌표가 바뀌었을 때 발생하는 이벤트를 등록합니다
      kakao.maps.event.addListener(rv, 'position_changed', function() {

      // 현재 로드뷰의 위치 좌표를 얻어옵니다
      var rvPosition = rv.getPosition();

      // 지도의 중심을 현재 로드뷰의 위치로 설정합니다
      map.setCenter(rvPosition);

      // 지도 위에 로드뷰 도로 오버레이가 추가된 상태이면
       if(overlayOn) {
        // 마커의 위치를 현재 로드뷰의 위치로 설정합니다
        marker.setPosition(rvPosition);
        }
      });

      // 마커 이미지를 생성합니다
      var markImage = new kakao.maps.MarkerImage(
      'https://t1.daumcdn.net/localimg/localimages/07/2018/pc/roadview_minimap_wk_2018.png',
     new kakao.maps.Size(26, 46),
      {
        // 스프라이트 이미지를 사용합니다.
        // 스프라이트 이미지 전체의 크기를 지정하고
        spriteSize: new kakao.maps.Size(1666, 168),
        // 사용하고 싶은 영역의 좌상단 좌표를 입력합니다.
        // background-position으로 지정하는 값이며 부호는 반대입니다.
        spriteOrigin: new kakao.maps.Point(705, 114),
        offset: new kakao.maps.Point(13, 46)
      }
      );

      // 드래그가 가능한 마커를 생성합니다
      var marker = new kakao.maps.Marker({
          image : markImage,
          position: mapCenter,
          draggable: true
      });

      // 마커에 dragend 이벤트를 등록합니다
      kakao.maps.event.addListener(marker, 'dragend', function(mouseEvent) {

          // 현재 마커가 놓인 자리의 좌표입니다
          var position = marker.getPosition();

          // 마커가 놓인 위치를 기준으로 로드뷰를 설정합니다
          toggleRoadview(position);
      });

      //지도에 클릭 이벤트를 등록합니다
      kakao.maps.event.addListener(map, 'click', function(mouseEvent){

          // 지도 위에 로드뷰 도로 오버레이가 추가된 상태가 아니면 클릭이벤트를 무시합니다
          if(!overlayOn) {
              return;
          }

          // 클릭한 위치의 좌표입니다
          var position = mouseEvent.latLng;

          // 마커를 클릭한 위치로 옮깁니다
          marker.setPosition(position);

          // 클락한 위치를 기준으로 로드뷰를 설정합니다
          toggleRoadview(position);
      });

      // 전달받은 좌표(position)에 가까운 로드뷰의 파노라마 ID를 추출하여
      // 로드뷰를 설정하는 함수입니다
      function toggleRoadview(position){
          rvClient.getNearestPanoId(position, 50, function(panoId) {
              // 파노라마 ID가 null 이면 로드뷰를 숨깁니다
              if (panoId === null) {
                  toggleMapWrapper(true, position);
              } else {
               toggleMapWrapper(false, position);

                  // panoId로 로드뷰를 설정합니다
                  rv.setPanoId(panoId, position);
              }
          });
      }

      // 지도를 감싸고 있는 div의 크기를 조정하는 함수입니다
      function toggleMapWrapper(active, position) {
          if (active) {

              // 지도를 감싸고 있는 div의 너비가 100%가 되도록 class를 변경합니다
              container.className = '';

              // 지도의 크기가 변경되었기 때문에 relayout 함수를 호출합니다
              map.relayout();

              // 지도의 너비가 변경될 때 지도중심을 입력받은 위치(position)로 설정합니다
              map.setCenter(position);
          } else {

              // 지도만 보여지고 있는 상태이면 지도의 너비가 50%가 되도록 class를 변경하여
              // 로드뷰가 함께 표시되게 합니다
              if (container.className.indexOf('view_roadview') === -1) {
                  container.className = 'view_roadview';

                  // 지도의 크기가 변경되었기 때문에 relayout 함수를 호출합니다
                  map.relayout();

                  // 지도의 너비가 변경될 때 지도중심을 입력받은 위치(position)로 설정합니다
                  map.setCenter(position);
              }
          }
      }

      // 지도 위의 로드뷰 도로 오버레이를 추가,제거하는 함수입니다
      function toggleOverlay(active) {
          if (active) {
              overlayOn = true;

              // 지도 위에 로드뷰 도로 오버레이를 추가합니다
              map.addOverlayMapTypeId(kakao.maps.MapTypeId.ROADVIEW);

              // 지도 위에 마커를 표시합니다
              marker.setMap(map);

              // 마커의 위치를 지도 중심으로 설정합니다
              marker.setPosition(map.getCenter());

              // 로드뷰의 위치를 지도 중심으로 설정합니다
              toggleRoadview(map.getCenter());
          } else {
              overlayOn = false;

              // 지도 위의 로드뷰 도로 오버레이를 제거합니다
              map.removeOverlayMapTypeId(kakao.maps.MapTypeId.ROADVIEW);

              // 지도 위의 마커를 제거합니다
              marker.setMap(null);
          }
      }

      // 지도 위의 로드뷰 버튼을 눌렀을 때 호출되는 함수입니다
      function setRoadviewRoad() {
          var control = document.getElementById('roadviewControl');

          // 버튼이 눌린 상태가 아니면
          if (control.className.indexOf('active') === -1) {
              control.className = 'active';

              // 로드뷰 도로 오버레이가 보이게 합니다
              toggleOverlay(true);
          } else {
              control.className = '';

              // 로드뷰 도로 오버레이를 제거합니다
              toggleOverlay(false);
          }
      }

      // 로드뷰에서 X버튼을 눌렀을 때 로드뷰를 지도 뒤로 숨기는 함수입니다
      function closeRoadview() {
          var position = marker.getPosition();
          toggleMapWrapper(true, position);
      }

    </script>
  <br>
  <div th:if="${lerad}!=null">
    <table class="table table-condensed" style="width: 1000px;">
      <caption style="caption-side: top; text-align: center;"><strong style="font-size: large">Leisure Map에 등록된
        사업장 목록</strong></caption>
      <thead>
        <tr>
          <th>이름</th>
          <th>주소</th>
          <th>종류</th>
        </tr>
      </thead>
      <tbody>
        <tr th:each="leisure: ${le_list}">
          <td><a th:text="${leisure.lebname}" th:href="@{leisureDetail(id=${leisure.leid})}"></a></td>
          <td><a th:text="${leisure.lerad}" th:href="@{leisureDetail(id=${leisure.leid})}"></a></td>
          <td th:text="${leisure.lecname}"></td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
<br>
</body>
</html>